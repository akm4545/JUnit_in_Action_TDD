# **프레젠테이션 계층 테스트**  
프레젠테이션 계층 테스트는 간단히 말해서 애플리케이션의 GUI에서 버그를 찾는 작업이다. GUI에서 오류를 찾는 작업은 다른 애플리케이션 계층에서  
오류를 찾는 일만큼이나 중요한 작업이다. 나쁜 사용자 경험은 사용자로 하여금 해당 사이트 이용을 꺼리게 만들어 결국 사용자를 잃게 만든다. 또한 유저  
인터페이스의 버그 때문에 애플리케이션의 다른 부분이 오작동할 수도 있다.  
  
사용자와 상요작용한다는 GUI의 속성 떄문에 GUI 테스트에는 독특한 과제가 있으며 이를 위한 고유한 도구와 기술이 필요하다.  
  
웹 사이트와의 상호작용을 테스트한다는 것은 지속성 관점에서 어려운 일일 수 있다. 시간이 지나면서 웹 사이트 콘텐츠가 변경될 수 있고 인터넷 연결에  
문제가 발생할 수도 있다. 이런 일들이 일어나면 테스트는 일시적으로 혹은 영구적으로 실패할 수도 있다. 따라서 이 장에 제시하는 테스트는 웬만하면  
UI가 변경되지 않을 사이트를 대상으로 하여 테스트가 되도록 오래 유효하게끔 설계되었다.  
  
이 장에서는 다음 내용을 테스트한다.  
- (맞춤법을 포함하여) 웹 페이지의 콘텐츠를 세부적인 수준까지 검증한다.  
- 애플리케이션 구조 또는 내비게이션(예를 들어 링크를 클릭해서 예상되는 페이지로 이동하는지 확인)을 검증한다.  
- 유저 스토리를 인수 테스트로 검증한다.  
  
유저 스토리(user story)는 소프트웨어의 기능을 자연어로 설명한 것을 말한다. 인수 테스트(acceptance test)는 기능 명세의 요구 사항을  
충족했는지를 확인하기 위해 수행하는 테스트다. 웹 애플리케이션이 특정 브라우저나 OS에서 제대로 동작하는지도 검증한다.  
  
# **테스트 프레임워크 선택하기**  
JUnit5 에서 프레젠테이션 계층 테스트를 수행하기 위한 두 가지 오픈 소스 도구인 HtmlUnit과 Selenium이 있다. HtmlUnit은 헤드리스 브라우저  
(headless browser)를 사용하는 테스트 프레임워크로 자바로 만들어졌으므로 JUnit5 테스트와 동일한 가상 머신에서 실행할 수 있다. 헤드리스  
브라우저란 GUI를 제공하지 않는 브라우저다. 즉 브라우저 창이나 유저 인터페이스 없이 프로그램으로 브라우저를 조작하는 방식을 말한다. 애플리케이션이  
OS나 자바스크립트, DOM, CSS 같은 브라우저별 구현과 독립적일 때 HtmlUnit을 사용한다.  
  
반면 Selenium은 다양한 웹 브라우저를 프로그래밍 방식으로 실제로 구동하며 JUnit5 테스트 실행 결과를 보여 준다. 특정 브라우저 버전이나 OS를  
검증하고자 할 때 Selenium을 사용한다. 애플리케이션이 자바스크립트, DOM, CSS 등 브라우저에 특화된 구현을 사용하거나 이에 의존하는 경우에도  
Selenium을 사용할 수 있다.  
  
# **HtmlUnit 살펴보기**  
HtmlUnit은 헤드리스 브라우저를 사용하는 테스트 프레임워크이며 자바로 만들어진 오픈 소스다. HtmlUnit은 사용자가 브라우저 기반 웹 애플리케이션을  
프로그래밍 방식으로 테스트할 수 있게 해 준다. 그러나 HtmlUnit과 JUnit5를 사용한 테스트는 유저 인터페이스를 시각적으로 보여 주지는 않는다.  
  
# **HtmlUnit 실전 예제**  
htmlunit 패키지 -> ManageWebClient 클래스 참조  
  
첫 번째 HtmlUnit 예제  
htmlunit 패키지 -> HtmlUnitPageTest 클래스 참조  
  
# **HtmlUnit 테스트 작성하기**  
HtmlUnit 테스트 작성은 웹 브라우저를 사용하는 사용자의 행동을 시뮬레이션하는 것과 같다. 우리는 브라우저를 사람 손으로 일일이 조작하는 대신  
에뮬레이션된 브라우저를 프로그래밍 방식으로 제어하는 것이다. 이렇게 하면 각 단계마다 HTML 모델 객체를 쿼리하고 그 값이 예상한 바와 일치하는지  
확인할 수 있다. 프레임워크가 문제를 감지하면 예외를 던지므로 오류를 확인할 필요가 없어져 테스트가 간결해진다.  
  
# **HTML 단언문**  
단언문은 단위 테스트의 핵심적인 요소다. HtmlUnit은 JUnit5와 연계가 가능하지만 WebAssert라는 비슷한 개념의 클래스를 제공한다. WebAssert  
클래스에서는 assertTitleEquals, assertTextPresent, notNull 같은 HTML에 관한 표준적인 단언문을 제공한다.  
  
# **특정한 웹 브라우저 테스트하기**  
HtmlUnit 2.50 버전 이후부터는 아래의 브라우저를 지원한다.  
웹 브라우저와 버전 / HtmlUnit BrowserVersion 상수  
- 엣지(최신 버전) / BrowserVersion.EDGE  
- 파이어폭스(최신 버전) / BrowserVersion.FIREFOX  
- 파이어폭스 7.8 / BrowserVersion.FIREFOX_78  
- 크롬(최신 버전) / BrowserVersion.CHROME  
- 현 시점 가장 잘 지원되는 브라우저 / BrowserVersion.BEST_SUPPORTED  
  
브라우저 버전을 특정하지 않았을 때 WebClient는 디폴트로 BrowserVersion.BEST_SUPPORTED를 에뮬레이션한다. 특정한 버전의 브라우저를  
에뮬레이션하려면 아래와 같이 사용한다.  
  
WebClient webClient = new WebClient(BrowserVersion.FIREFOX_78);  
  
