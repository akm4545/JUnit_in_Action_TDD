# **스텁을 활용한 거친 테스트**  
특정한 런타임 환경에 의존하는 애플리케이션을 위한 단위 테스트를 작성하기는 매우 어렵다. 테스트는 안정적이어야 하며 반복적으로  
수행해도 같은 결과가 나와야 하기 떄문이다. 즉 테스트가 실행되는 환경을 제어할 필요가 있는데 이를 위한 방법으로는 실제로 필요한  
환경을 테스트의 일부로 구성하여 테스트를 수행하는 것이다. 때로는 이런 방식이 효과적일 수 있다. 개발 주기로 보자면 개발 단계나  
빌드 단계에서 실제 환경을 제공하는 것도 물론 도음이 된다. 그러나 이는 항상 가능한 방법은 아니다.  
  
예를 들어 개발 중인 애플리케이션이 타사에서 제공하는 웹 서버에 HTTP 통신을 해야 하는 경우 개발 환경에서는 그런 서버 통신을  
하는 것이 사실상 불가능하다. 이때 타사의 웹 서버를 모사하거나 가짜를 만들어 메꿀 수 있다. 가짜 객체를 황용하는 방법은 크게  
두 가지다. 하나는 스텁을 활용하는 것이고 다른 하나는 모의 객체를 활용하는 것이다.  
  
스텁을 사용한다면 스텁이 사전에 정의된 동작만을 수행한다는 점을 유의해야 한다. 스텁 코드는 테스트 외부에 만들어져 있으며  
사용하는 위치나 횟수와 관계없이 동일한 동작을 수행하는데 일반적으로 하드코딩한 값을 반환한다. 스텁으로 테스트할 때는  
스텁 초기화 -> 테스트 실행 -> 단언문 검증 순서로 진행한다.  
  
모의 객체는 사전에 정의된 동작을 수행하지는 않는다. 대신 테스트 실행 중에 모의 객체가 수행할 행동을 기대할 수 있다. 다른  
테스트를 실행하고 모의 객체를 다시 초기화한 뒤 새로운 행동을 기대하는 것도 가능하다. 모의 객체로 테스트할 때는   
모의 객체 초기화 -> 기대 설정 -> 테스트 실행 -> 단언문 검증 순서로 진행한다.  
  
