# **스프링 애플리케이션 테스트**  
자바 애플리케이션 개발을 위한 오픈 소스 프레임워크인 스프링은 가볍고 유연하며 범용적이다. 스프링은 특정 계층에만 적용되는 프레임워크가 아니며 자바  
애플리케이션의 어느 계층에서든 사용 가능하다.  
  
# **스프링 프레임워크 살펴보기**  
라이브러리란 코드를 재사용할 수 있게 해 주는 클래스 또는 함수의 모음이다. 개발자는 라이브러리를 통해 다른 개발자가 만든 코드를 사용할 수 있다.  
대부분의 라이브러리는 특정한 분야 전용으로 쓰인다.  
  
소프트웨어 프레임워크는 일반적인 기능은 재사용할 수 있도록 하고 특정한 기능은 사용자가 코드를 통해 선택적으로 구현 가능하도록 하는 추상 구조를  
말한다. 개발자는 프레임워크를 활용해 개별적인 소프트웨어를 만들 수 있다. 프레임워크는 개발자로 하여금 특정한 패러다임을 따르게 함으로써 소프트웨어  
애플리케이션을 개발하는 것을 지원한다. 라이브러리와 프레임워크의 주요한 차이점은 바로 제어의 역전에 있다. 라이브러리에서는 메서드를 호출하면  
사용자가 해당 메서드를 직접 제어할 수 있다. 그러나 프레임워크를 사용하면 제어가 역전된다. 즉 프레임워크가 사용자의 코드를 호출하는 것이다.  
개발자는 프레임워크에서 제공하는 패러다임을 따라야 하고 그에 맞추어 코드를 작성해야 한다. 프레임워크가 스켈레톤을 정의했다면 개발자는 기능을  
추가하여 스켈레톤에 살을 붙인다. 개발자의 코드는 프레임워크가 제어하며 프레임워크가 개발자의 코드를 호출한다. 그럼 개발자는 설계보다 비즈니스  
로직을 구현하는 데 집중할 수 있다.  
  
스프링 프레임워크는 자바 애플리케이션 개발을 위한 종합적인 환경을 제공한다. 스프링은 개발자가 애플리케이션을 개발하는 데 집중할 수 있도록 환경을  
구성해 주고 자바 일반 객체(plain old Java object / POJO)를 가지고 애플리케이션을 개발 할 수 있게 해 준다.  
  
# **의존성 주입 살펴보기**  
일반적인 자바 애플리케이션은 애플리케이션을 구성하기 위해 협력하는 객체로 이루어져 있다. 즉 애플리케이션을 구성하는 객체들은 서로 의존성을 가지게  
된다. 이때 애플리케이션 구성은 개발자나 아키텍트의 몫이 된다. 그리고 클래스와 객체를 구성하기 위해(팩토리, 빌더, 프록시, 데코레이터 등) 여러  
가지 디자인 패턴을 적용할 수 있는데 패턴을 적용하는 부담은 결국 개발자에게 돌아간다.  
  
스프링에는 여러 디자인 패턴이 구현되어 있다. 그중에서도 의존성 주입(또는 제어의 역전) 패턴은 서로 다른 컴포넌트를 조합하여 제대로 동작하는 하나의  
애플리케이션을 구성하도록 해준다.  
  
개발자가 코드 수준에서 의존성을 관리해야 했던 기존 방식 예제  
cp 패키지 하위 참조  
  
d위와 같은 접근 방식에는 몇 가지 단점이 있다.  
- 클래스 A가 클래스 B에 직접적으로 의존한다.  
- A와 B를 별도로 분리해서 테스트하는 것이 어렵다.  
- A에 의해 객체 B의 수명이 결정될 수 있다. 객체 A에서 객체 B를 사용하고 있으므로 다른 곳에서 클래스 B를 재사용할 수 있음에도 사용하지 못할 수  
있다.  
- B를 다른 구현으로 대체할 수 없다.  
  
이러한 단점들은 의존성 주입이라는 새로운 접근 방식을 유도하게 된다.  
  
의존성 주입을 적용하면 각 객체들은 컨테이너에 의해 관리되고 컨테이너가 다른 객체를 만들 때 의존성을 주입하게 된다. 이는 제어가 역전된다는 점에서  
개발자가 의존성을 직접 관리하던 기존의 접근 방식과는 본질적으로 구분된다. 의존성 주입의 기본적인 발상은 애플리케이션 컴포넌트 간의 직접적인  
의존성을 제거하고 클래스를 인스턴스화할 수 있는 권한을 전부 컨테이너에 위임하는 것이다.  

객체 간의 직접적인 의존성 제거    
cp 패키지 하위 참조  
  
XML은 스프링 애플리케이션을 구성하는 전통적인 방법으로 여전히 자주 사용된다. XML은 다른 의존성을 건드릴 염려가 적다. 코드가 프레임워크에서  
사용되고 있다는 사실을 인식하지 못할뿐더러 외부 의존성과도 엮이지 않는다. 또한 구성이 변경된다고 하더라도 XML 파일만 바꾸면 되므로 코드를 다시  
컴파일할 필요도 없다. 이는 기술적인 배경 지식이 부족한 테스터에게 상대적으로 유용하다.  
  
의존성 관리는 컨테이너에 위임한다.  
test 패키지 -> resources 패키지 -> application-context.xml 참조  
  
스프링 프레임워크는 application-context.xml 파일을 가지고 빈과 의존성을 생성하고 관리한다.  
스프링 컨테이너가 다루는 객체는 일반적으로 빈이라고 부른다. 빈은 제어의 역전이 적용되어 있는 스프링 컨테이너에 의해 관리되며 애플리케이션의 핵심을  
이루는 객체다.  
  
스프링 컨테이너에 빈을 등록하면 다음과 같은 장점이 있다.  
- 어떤 타입의 객체라도 컨테이너에 요청하면 컨테이너가 알아서 해당 객체를 반환해 준다.  
- 각자의 객체는 서로 독립적이게 되며 다른 외부 라이브러리에도 의존하지 않는다. 이 객체들은 완벽히 자바 일반 객체가 된다.  
- application-context.xml 파일에 시스템에서 필요한 객체 간의 의존성을 문서화 할 수 있다.  
- 컨테이너가 객체의 생애 주기를 제어할 수 있다.  
- 클래스와 컴포넌트를 재사용하는 것이 쉽다.  
- 코드가 더 깔끔해진다(클래스는 보조 객체를 만들 필요가 없다).  
- 단위 테스트가 더욱 단순해진다. 클래스는 단순해지고 다른 의존성으로 인해 어수선해지지 않는다.  
- 시스템에서 객체 간의 의존성을 변경하는 것이 매우 쉬워진다. applicaiton-context.xml 파일만 변경하면 된다. 자바 파일을 다시 컴파일할 필요가  
없다. 오히려 구현이 바뀔 수 있는 모든 객체를 의존성 주입(제어의 역전) 컨테이너에 넣어 두는 것이 권장된다.  
  
컨테이너를 인스턴스화하고 구동할 때 비즈니스 클래스가 컨테이너 구성 관련 메타데이터와 결합한다. 결과적으로 애플리케이션을 완전히 구성한 상태로 만들  
수 있으며 즉시 실행 가능한 애플리케이션을 얻을 수 있다.  
  
# **스프링 콘텍스트를 프로그래밍 방식으로 만들기**  
스프링 애플리케이션을 위한 첫 번째 단위 테스트 예제  
cp 패키지 -> SimpleAppTest 클래스 참조  
  
