# **모의 객체로 테스트하기**  
개별 메서드 단위 테스트 시 다른 환경이나 다른 메서드와 격리하는 것은 좋은 목표다. 이를 위해 스텁을 활용하여 소스  
코드를 웹 서버, 파일 시스템, 데이터베이스 등의 환경에서 격리하여 단위 테스트를 할 수 있었다. 메서드 호출을 다른  
클래스로부터 격리하는 것과 같이 조금 더 세밀한 격리에서는 모의 객체를 사용한다.  
  
모의 객체의 개념은 팀 매키넌, 스티브 프리먼, 필립 크레이그가 XP2000에서 처음 제시했다. 모의 객체를 사용하면  
가능한 한 가장 세밀한 수준에서 테스트를 실행할 수 있다. 각 메서드별로 개별적인 단위 테스트를 만들어 개발하는  
것이 가능하다.  
  
# **모의 객체란 무엇인가**  
다른 클래스나 메서드와 격리된 상태에서 테스트를 하면 큰 이점이 있다. 작업할 인터페이스가 구성되어 있기만 하다면  
아직 완성되지 않은 코드도 테스트할 수 있다는 것이다. 격리된 상태에서의 테스트는 다른 부분의 코드가 완성되는  
것을 기다리지 않고 한 부분의 코드를 단위 테스트하는 데 큰 도움이 된다.  
  
모의 객체를 사용할 때의 가장 큰 장점은 메서드에 집중하는 테스트를 만들 수 있다는 것이다. 모의 객체를 사용하면  
테스트 대상 메서드가 메서드가 다른 객체를 호출해서 발생하는 부수 효과가 생길 일이 없다. 테스트를 작게, 목표한  
부분만 집중하여 작성하는 것은 이해하기 쉬운 테스트를 만들고 코드의 다른 부분이 변경되어도 테스트가 깨지지 않게  
한다는 점에서 효과가 크다. 단위 테스트의 장점은 리팩토링할 수 있도록 확신을 준다는 것이다. 단위 테스트는  
회귀를 막기 위한 안전장치다. 모의 객체를 활용해 세밀한 테스트트 하면 더 적은 테스트가 영향을 받게 되고 실패의  
원인을 정확히 찾아 주는 간명한 에러 메시지를 받을 수 있다.  
  
모의 객체는 비즈니스 로직의 일부만을 다른 부분과 격리해 테스트하는 데 적합하다. 모의 객체는 테스트 대상인  
메서드가 사용하는 객체를 대체하므로 테스트 대상 메서드는 다른 객체와 격리되는 효과가 생긴다. 그런 의미에서  
모의 객체는 스텁과 비슷하기도 하다. 그러나 모의 객체는 비즈니스 로직을 새로 구현할 필요가 없다. 모의 객체는  
테스트가 가짜로 만든 클래스의 모든 비즈니스 로직을 제어하도록 하는 껍데기일 뿐이다.  
  
스텁은 사전에 정의된 동작만 수행한다. 간단한 동작이라도 스텁의 행동은 런타임에 따라 달라지지 않는다. 반면  
모의 객체에서 사전에 정의된 동작은 없으며 대신 테스트를 실행하는 중에 모의 객체가 수행할 행동을 기대할 수  
있다. 다른 테스트를 수행할 때는 모의 객체를 새로 초기화한 다음 새로운 행동을 기대하면 된다. 모의 객체를  
활용한 테스트는 모의 객체 초기화 -> 기대 설정 -> 테스트 실행 -> 단언문 검증 순서로 진행된다.  
